## Project A - 비지도 학습 기반 사출 품질 예측 및 최적 세팅 추천 시스템
(A사 자동차 부품 제조기업 / 자율형 공장 구축 사업 / 2023.08 ~ 2025.07)

--- 

### 프로젝트 개요
- 1:1 라벨이 부재한 사출 공정 데이터를 기반으로 **군집화 + 비지도 이상 탐지 모델**을 활용한 불량 탐지 시스템 구축.
- 설비·품목·세팅 조건별 데이터 분포 특성을 반영하여 **유연한 추론 로직** 적용.
- 예측 기반 라벨링으로 품질 통계 및 최적 생산 조건을 정량화하여 **작업자 가이던스 제공 및 불량률 감소**.
--- 

### 문제 정의
- 1.) **1:1 라벨링 부재**
  - PostgreSQL 기반 Raw 사출 데이터는 Lot(일 단위) 생산량 단위로만 Good/Bad 품질이 기록됨.
  - 개별 샘플 단위의 품질 라벨이 없어 샘플 단위 품질 판정 불가.
- 2.) **Setting 조합별 데이터 분포 상이**
  - 동일 Maker·Facility·Item 조합이라도 생산은 다른 Setting(공정 조건)으로 운영.
  - Setting 조합에 따라 입력 분포가 크게 달라 **독립 학습군 구성 필요**.
--- 

### 주요 전처리 및 비지도 학습 방법
- 1.) **Lot 단위 품질 통계 기반 데이터 정의**
  - Lot별 불량률(defect_rate) 산출.
  - 총 불량률 1% 미만 데이터는 학습용, 그 이상은 검증용으로 분리 → 과적합 방지.
- 2.) **Unique Setting 조합 및 클러스터링**
  - 다변량 Setting 데이터를 중복 제거 후 고유 조합 추출.
  - K-Means로 Cluster 번호를 부여해 Cluster 단위 학습 데이터셋 구성.
  - 500개 미만 데이터 학습 제외
- 3.) **클러스터별 비지도 학습 모델 구성**
  - 샘플 수 기준 모델 선택:
    - 5000개 이상: **Memory-Augmented AutoEncoder**
    - 1000~5000개: **AutoEncoder**
    - 1000개 미만: **IsolationForest**
  - AE 기반 모델은 Early Stopping 및 Best Weight 적용으로 학습 안정성 확보.

--- 

### 실시간 추론 프로세스
- 1.) **MongoDB 기반 실시간 전처리**
  - 결측치(품목명, 세팅, 생산량 등)는 Forward/Backward/Mean/Mode Fill로 보완.
  - 예측 불가 조건은 사전 예외 처리 → 시스템 중단 방지.
- 2.) **기본 추론 (학습 이력 존재)**
  - 현재 Setting → Cluster 예측 → 해당 Cluster 학습 모델 불러오기.
  - MinMaxScaler(clip=True) 적용으로 발산 방지.
  - MAE Loss 분포의 변동계수(CV)를 활용해 **Threshold 가중치 및 Margin 부여**.
- 3.) **적응형 추론 (학습 이력 없음 or 학습불가 Setting)**
  - Euclidean Distance 기반 현재 Setting의 **최근접 Trained Setting 정보 탐색**.
  - 최근접 Cluster 학습 모델로 대체 추론 수행.
  - 기존 Threshold 대신 trained mae loss CV + 거리 기반 **Threshold 가중치 및 Margin 부여**

--- 

### 최적 생산 조건 도출 및 품질 가이던스
- 1.) **모델 기반 임시 라벨링**
  - AE 기반 Threshold로 기존 데이터에 비지도 품질 라벨 부여.
- 2.) **설비·품목 기준 최적 세팅 정리**
  - 과거 생산 이력 중 최다 생산 + 최소 예측 불량률 세팅 도출.
  - 각 세팅 조합별 Min/Mean/Max 통계 산출.
- 3.) **생산 계획용 데이터셋 구축**
  - 라벨링된 데이터를 기반으로 설비·품목별 최적 조건 가이던스 제공.

--- 

### 주요 성과
- 초기 실험 데이터 기준 불량 탐지 정확도 92%, 현장 적용 시 **67% 수렴 (False Negative 문제 다수 발생)**
- Threshold 유연성 강화 및 적응형 추론 고도화 적용 후 불량 탐지 정확도 **평균 16% 향상.**
- 예측 기반 품질 통계 활용 → 생산 불량률 **약 5% 감소 달성.**
--- 

### 기여도 
- **데이터 전처리** 및 K-Means 기반 **세팅 분할**·클러스터링 **로직 설계**.
- **AE/MemAE 기반 비지도 이상 탐지 모델 개발** 및 학습 안정화 구조 고도화.
- **실시간 품질 추론 로직 및 적응형 추론 알고리즘** 구현.
- **Threshold 가중치 및 Margin 기반 추론 유연화 전략** 설계.
- 모델 기반 라벨링 및 **최적 생산 조건 정량화 모듈** 구축.
--- 

